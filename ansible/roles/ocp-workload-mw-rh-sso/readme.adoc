Role Name
=========

ocp-workload-rh-sso role is intended to add a red hat sso authentication infrastructure with a persistent rh-ssh instance.

It is intended to have a security domain for each student to configure and integrate additional applications to this role based authentication server.


== Execution using localhost oc client

-----
WORKLOAD="ocp-workload-mw-rh-sso"
SUBDOMAIN_BASE=`oc whoami --show-server | cut -d'.' -f 2,3,4,5 | cut -d':' -f 1`


########        Provision RH-SSO        #################
ansible-playbook -i localhost, -c local ./configs/ocp-workloads/ocp-workload.yml \
                    -e"ANSIBLE_REPO_PATH=`pwd`" \
                    -e"ocp_workload=${WORKLOAD}" \
                    -e"ocp_user_needs_quota=true" \
                    -e"ACTION=create" \
                    -e"subdomain_base=$SUBDOMAIN_BASE"




#######         Realm management        ###################
START_REALM=1
END_REALM=1

smtp_host=
smtp_userid=
smtp_passwd=

# Create Realms
ansible-playbook -i localhost, -c local ./configs/ocp-workloads/ocp-workload.yml \
                    -e"ANSIBLE_REPO_PATH=`pwd`" \
                    -e"ocp_workload=${WORKLOAD}" \
                    -e"ACTION=realm_mgmt" \
                    -e"start_realm=$START_REALM" \
                    -e"end_realm=$END_REALM" \
                    -e"subdomain_base=$SUBDOMAIN_BASE" \
                    -e"smtp_host=$smtp_host" \
                    -e"smtp_passwd=$smtp_passwd" \
                    -e"smtp_userid=$smtp_userid" \
                    -e"create_realms=true"

# Delete Realms
ansible-playbook -i localhost, -c local ./configs/ocp-workloads/ocp-workload.yml \
                    -e"ANSIBLE_REPO_PATH=`pwd`" \
                    -e"ocp_workload=${WORKLOAD}" \
                    -e"ACTION=realm_mgmt" \
                    -e"start_realm=$START_REALM" \
                    -e"end_realm=$END_REALM" \
                    -e"subdomain_base=$SUBDOMAIN_BASE" \
                    -e"create_realms=false"




#######         Delete RH-SSO           ################
ansible-playbook -i localhost, -c local ./configs/ocp-workloads/ocp-workload.yml \
                    -e"ANSIBLE_REPO_PATH=`pwd`" \
                    -e"ocp_workload=${WORKLOAD}" \
                    -e"ACTION=remove" \
                    -e"subdomain_base=$SUBDOMAIN_BASE"
-----
